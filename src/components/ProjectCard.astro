---
import GitHubLogo from "@astropub/icons/GitHubLogo";
import { FileText } from "lucide-react";
import type { Project } from "../data/projects";
import { border_radius, icon_size } from "../utils/constants";
import { getStatusConfig } from "../utils/getStatusConfig";

const {
    title = "string",
    description = "string",
    status = "production" as Project["status"],
    giturl = "string",
    tags = "string[]",
} = Astro.props;

const currentStatus = getStatusConfig(status);
const isInternalLink = giturl.startsWith("/");
---

<div
    class="card bg-base-100 border border-base-300 lg:card-side h-auto lg:h-72 project-card"
>
    <figure
        class="bg-base-200 w-full h-64 lg:w-80 lg:h-full shrink-0 project-figure"
    >
        <div
            class="flex items-center justify-center w-full h-full text-base-content/30"
        >
            <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
                class="w-24 h-24"
            >
                <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"
                ></path>
            </svg>
        </div>
    </figure>
    <div class="card-body flex-1">
        <div class="flex items-center gap-2 flex-wrap">
            <h2 class="card-title text-base">{title}</h2>
            <div class="inline-grid *:[grid-area:1/1]">
                <div
                    class={`w-2 h-2 rounded-full animate-ping ${currentStatus.color}`}
                >
                </div>
                <div class={`w-2 h-2 rounded-full ${currentStatus.color}`}>
                </div>
            </div>
            <span class="badge badge-ghost badge-sm">{currentStatus.text}</span>
        </div>
        <p class="text-sm opacity-80 flex-1">{description}</p>
        <div class="card-actions gap-8 items-center mt-auto">
            <div class="flex flex-wrap gap-2">
                {
                    tags.map((tag: string) => (
                        <div class="badge badge-outline badge-md">{tag}</div>
                    ))
                }
            </div>
            {
                isInternalLink ? (
                    <button
                        onclick={`document.getElementById('modal-${giturl.replace(/\//g, "-")}').showModal()`}
                        class="btn gap-2"
                        aria-label="Read more about this project"
                        title="Read more about this project"
                    >
                        Read More
                    </button>
                ) : (
                    <a
                        href={giturl}
                        target="_blank"
                        class="btn gap-2"
                        aria-label="View source code on GitHub"
                        title="View source code on GitHub"
                    >
                        <GitHubLogo width={icon_size} height={icon_size} />
                        GitHub
                    </a>
                )
            }
        </div>
    </div>
</div>

<style define:vars={{ border_radius }}>
    .project-card {
        border-radius: var(--border_radius);
    }

    .project-figure {
        border-radius: var(--border_radius) var(--border_radius) 0 0;
    }

    @media (min-width: 1024px) {
        .project-figure {
            border-radius: var(--border_radius) 0 0 var(--border_radius);
        }
    }
</style>
